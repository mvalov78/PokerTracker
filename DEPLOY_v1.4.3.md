# üöÄ –î–µ–ø–ª–æ–π –≤–µ—Ä—Å–∏–∏ 1.4.3 - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–π –±–æ—Ç–∞

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git status

# 2. –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add .
git commit -m "fix: –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–π –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–æ—Ç–æ –≤ –±–æ—Ç–µ (v1.4.3)"

# 3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git push origin main
```

Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ production.

## üìã –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞
```
TypeError: Cannot set properties of undefined (setting 'ocrData')
```

### –†–µ—à–µ–Ω–∏–µ
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–∏ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º  
‚úÖ –£–ª—É—á—à–µ–Ω middleware –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–µ—Å—Å–∏–π  
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ callback queries  
‚úÖ –£–ª—É—á—à–µ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö  

## üìù –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. ‚úÖ `src/bot/handlers/photoHandler.ts` - –ü—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Å—Å–∏–∏
2. ‚úÖ `src/app/api/telegram/webhook/route.ts` - –£–ª—É—á—à–µ–Ω middleware
3. ‚úÖ `package.json` - –í–µ—Ä—Å–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ 1.4.3
4. ‚úÖ `.cursor/rules/global.mdc` - –í–µ—Ä—Å–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
5. ‚úÖ `docs/QUICK_FIX_SESSION_ERROR.md` - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
6. ‚úÖ `docs/RELEASE_v1.4.3.md` - –†–µ–ª–∏–∑ –Ω–æ—Ç—ã

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. ‚úÖ –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ –±–∏–ª–µ—Ç–∞ –≤ –±–æ—Ç
2. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ OCR –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—è–≤–ª—è—é—Ç—Å—è –∫–Ω–æ–ø–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
4. ‚úÖ –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å" –∏–ª–∏ "–û—Ç–º–µ–Ω–∏—Ç—å"
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Vercel –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫

### Telegram Bot
–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –±–æ—Ç–∞:
```
1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å /start
2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ –±–∏–ª–µ—Ç–∞
3. –î–æ–∂–¥–∞—Ç—å—Å—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
4. –ù–∞–∂–∞—Ç—å "‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å"
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Vercel Dashboard
1. –ü–µ—Ä–µ–π—Ç–∏ –≤ [Vercel Dashboard](https://vercel.com/dashboard)
2. –í—ã–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç PokerTracker
3. –û—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É "Deployments"
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–µ–ø–ª–æ—è

### Logs
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ Vercel:
- Runtime Logs - –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
- Function Logs - –¥–ª—è webhook endpoint
- Edge Logs - –¥–ª—è –æ–±—â–∏—Ö –æ—à–∏–±–æ–∫

### –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö
‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –ª–æ–≥–∏:
```
[Telegram Webhook] –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: 12345
[Telegram Webhook] –°–µ—Å—Å–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: 12345
üì∏ –ü–æ–ª—É—á–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∞–π–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞: https://...
üîç –†–µ–∑—É–ª—å—Ç–∞—Ç OCR –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞: { success: true, ... }
```

‚ùå –û—à–∏–±–∫–∏ (–Ω–µ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–ª—è—Ç—å—Å—è):
```
TypeError: Cannot set properties of undefined (setting 'ocrData')
‚ùå [handleDocumentAsPhoto] –°–µ—Å—Å–∏—è –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
```

## üîÑ Rollback (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –æ—Ç–∫–∞—Ç–∏—Ç–µ—Å—å –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é –≤–µ—Ä—Å–∏—é:

```bash
# 1. –ù–∞–π—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–±–æ—á–∏–π commit
git log --oneline

# 2. –û—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é –≤–µ—Ä—Å–∏—é
git revert HEAD

# 3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git push origin main
```

–ò–ª–∏ —á–µ—Ä–µ–∑ Vercel Dashboard:
1. Deployments ‚Üí –í—ã–±—Ä–∞—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–ø–ª–æ–π
2. –ù–∞–∂–∞—Ç—å "Promote to Production"

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Vercel**
   - –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π deployment
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Runtime Logs –∏ Function Logs

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   - `TELEGRAM_BOT_TOKEN` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
   - `BOT_MODE` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "webhook"
   - `BOT_WEBHOOK_URL` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å webhook**
   ```bash
   # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ webhook
   cd scripts
   ./check-webhook.sh
   ```

4. **–°–≤—è–∑–∞—Ç—å—Å—è —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º**
   - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
   - –°–∫—Ä–∏–Ω—à–æ—Ç—ã –æ—à–∏–±–æ–∫
   - –õ–æ–≥–∏ –∏–∑ Vercel

## ‚úÖ Checklist –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [x] –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ
- [x] –õ–∏–Ω—Ç–µ—Ä –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–æ–∫
- [x] –í–µ—Ä—Å–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –≤ `package.json`
- [x] –í–µ—Ä—Å–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –≤ `global.mdc`
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- [x] –†–µ–ª–∏–∑ –Ω–æ—Ç—ã –≥–æ—Ç–æ–≤—ã

## üìà –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:
- ‚úÖ Telegram –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ OCR –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ö–Ω–æ–ø–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –¢—É—Ä–Ω–∏—Ä—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –õ–æ–≥–∏ —á–∏—Å—Ç—ã–µ, –±–µ–∑ –æ—à–∏–±–æ–∫

---

**–í–µ—Ä—Å–∏—è:** 1.4.3  
**–î–∞—Ç–∞:** 2025-10-31  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é ‚úÖ

