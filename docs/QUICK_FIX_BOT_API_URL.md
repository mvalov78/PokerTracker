# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Ç—É—Ä–Ω–∏—Ä–æ–≤" –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

## –ü—Ä–æ–±–ª–µ–º–∞

–ö–æ–º–∞–Ω–¥–∞ `/tournaments` (–∏ –¥—Ä—É–≥–∏–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞) –≤—ã–¥–∞—é—Ç –æ—à–∏–±–∫—É –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ, —Ö–æ—Ç—è –ª–æ–∫–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ.

**–ü—Ä–∏—á–∏–Ω–∞:** –ë–æ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ö–∞—Ä–¥–∫–æ–¥–Ω—ã–µ URL `http://localhost:3000`, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.

## –†–µ—à–µ–Ω–∏–µ

### 1. –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–¥–µ

‚úÖ –í—Å–µ —Ö–∞—Ä–¥–∫–æ–¥–Ω—ã–µ URLs –≤ `src/bot/commands.ts` –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ URL –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```typescript
function getApiUrl(): string {
  const appUrl =
    process.env.NEXT_PUBLIC_APP_URL ||
    process.env.NEXT_PUBLIC_API_URL ||
    process.env.VERCEL_URL ||
    "http://localhost:3000";
  
  // –ï—Å–ª–∏ URL –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å http/https - –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞–∫ –µ—Å—Ç—å
  if (appUrl.startsWith("http")) {
    return appUrl;
  }
  
  // –ò–Ω–∞—á–µ –¥–æ–±–∞–≤–ª—è–µ–º https –ø—Ä–æ—Ç–æ–∫–æ–ª (–¥–ª—è Vercel URL)
  return `https://${appUrl}`;
}
```

–≠—Ç–æ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö –º–µ—Å—Ç–∞—Ö:
- `/link` - —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ —Å –≤–µ–±-–∞–∫–∫–∞—É–Ω—Ç–æ–º
- `/result` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- `/stats` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- `/tournaments` - —Å–ø–∏—Å–æ–∫ —Ç—É—Ä–Ω–∏—Ä–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–æ–≤ —á–µ—Ä–µ–∑ API

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ Vercel

–ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ Vercel:

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Vercel

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ [Vercel Dashboard](https://vercel.com/dashboard)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **Environment Variables**
3. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:
   ```
   Name: NEXT_PUBLIC_API_URL
   Value: https://your-app.vercel.app
   ```
   (–ó–∞–º–µ–Ω–∏—Ç–µ `your-app.vercel.app` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π URL –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)

4. –í—ã–±–µ—Ä–∏—Ç–µ **Production**, **Preview**, **Development** (–≤—Å–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è)
5. –ù–∞–∂–º–∏—Ç–µ **Save**
6. **Redeploy** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Vercel CLI

```bash
# –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
vercel env add NEXT_PUBLIC_API_URL production

# –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –≤–≤–µ–¥–∏—Ç–µ: https://your-app.vercel.app
```

### 3. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ NEXT_PUBLIC_APP_URL

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `NEXT_PUBLIC_APP_URL`, –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ—ë:

```bash
vercel env add NEXT_PUBLIC_APP_URL production
# –í–≤–µ–¥–∏—Ç–µ: https://your-app.vercel.app
```

–ë–æ—Ç –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã –±–æ—Ç—É:

```bash
# –í –ª–æ–≥–∞—Ö Vercel –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
üåê API URL: https://your-app.vercel.app
```

### 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞

–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –¥–µ–ø–ª–æ—è:

1. –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –¥–µ–ø–ª–æ–µ
2. –ò–ª–∏ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –µ–≥–æ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å: `/admin/bot`
3. –ò–ª–∏ —á–µ—Ä–µ–∑ API:
   ```bash
   curl -X POST https://your-app.vercel.app/api/bot/restart
   ```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞:

```
/tournaments - –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ç—É—Ä–Ω–∏—Ä–æ–≤
/stats - –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
/result - –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:

1. `NEXT_PUBLIC_API_URL` - —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
2. `NEXT_PUBLIC_APP_URL` - –æ–±—â–∏–π URL –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  
3. `VERCEL_URL` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è Vercel
4. `http://localhost:3000` - fallback –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

- ‚úÖ `/src/bot/commands.ts` - –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
- ‚úÖ `/src/bot/handlers/photoHandler.ts` - —É–∂–µ –±—ã–ª –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ `/env.example` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–∞–µ—Ç—Å—è, –¥–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `commands.ts`:

```typescript
async listTournaments(ctx: BotContext) {
  try {
    const userId = ctx.from?.id.toString();
    const apiUrl = getApiUrl();
    
    console.log(`üåê [Bot] –ó–∞–ø—Ä–æ—Å –∫ API: ${apiUrl}/api/tournaments?userId=${userId}`);
    
    const apiResponse = await fetch(
      `${apiUrl}/api/tournaments?userId=${userId}`,
    );
    
    console.log(`üìä [Bot] API Response status: ${apiResponse.status}`);
    // ... rest of code
  }
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑ –ª–æ–≥–æ–≤ Vercel

–í –ª–æ–≥–∞—Ö —Ñ—É–Ω–∫—Ü–∏–π Vercel –≤—ã —É–≤–∏–¥–∏—Ç–µ:
```
üåê [Bot] –ó–∞–ø—Ä–æ—Å –∫ API: https://your-app.vercel.app/api/tournaments?userId=123
üìä [Bot] API Response status: 200
```

–ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –Ω–µ 200, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- API —Ä–æ—É—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ (`/api/tournaments`)
- –ï—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è userId

## –†–µ–∑—é–º–µ

‚úÖ **–ö–æ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω** - —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è  
‚úÖ **–õ–æ–∫–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `http://localhost:3000` –∫–∞–∫ fallback  
‚úÖ **–ù–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ** - –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `NEXT_PUBLIC_API_URL` –∏–ª–∏ `NEXT_PUBLIC_APP_URL`

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –¥–µ–ø–ª–æ—è –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å!

