# üìÅ SQL Scripts

–≠—Ç–∞ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ SQL —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö Supabase.

## üìã –°–ø–∏—Å–æ–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤

### üèóÔ∏è –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **`supabase-schema.sql`** - –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ –≤—Å–µ–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏, –∏–Ω–¥–µ–∫—Å–∞–º–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏

### üë§ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **`add-user-settings-table.sql`** - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `user_settings` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ (—Ç–µ–∫—É—â–∞—è –ø–ª–æ—â–∞–¥–∫–∞ –∏ –¥—Ä.)

### üîí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ RLS (Row Level Security)
- **`fix-rls-policies.sql`** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª RLS –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- **`disable-all-rls.sql`** - –û—Ç–∫–ª—é—á–µ–Ω–∏–µ RLS –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–ø–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è)
- **`disable-all-rls-final.sql`** - –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è RLS –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **`disable-rls-temp.sql`** - –í—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è RLS

## üöÄ –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –Ω–æ–≤–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

1. **–°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Å—Ö–µ–º—ã:**
   ```sql
   -- –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤ Supabase SQL Editor
   \i supabase-schema.sql
   ```

2. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
   ```sql
   -- –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤ Supabase SQL Editor
   \i add-user-settings-table.sql
   ```

3. **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ - –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ RLS:**
   ```sql
   -- –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤ Supabase SQL Editor
   \i disable-all-rls-final.sql
   ```

4. **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ RLS:**
   ```sql
   -- –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤ Supabase SQL Editor
   \i fix-rls-policies.sql
   ```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
- RLS –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å **–æ—Ç–∫–ª—é—á–µ–Ω–∞** –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `disable-all-rls-final.sql` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
- RLS –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å **–≤–∫–ª—é—á–µ–Ω–∞** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `fix-rls-policies.sql` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∞–≤–∏–ª –¥–æ—Å—Ç—É–ø–∞
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
- `users` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
- `tournaments` - –¢—É—Ä–Ω–∏—Ä—ã
- `tournament_results` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç—É—Ä–Ω–∏—Ä–æ–≤
- `tournament_photos` - –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –±–∏–ª–µ—Ç–æ–≤
- `bankroll_transactions` - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –±–∞–Ω–∫—Ä–æ–ª–ª–∞
- `user_sessions` - –°–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `user_settings` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –°–≤—è–∑–∏:
- `tournaments` ‚Üí `users` (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)
- `tournament_results` ‚Üí `tournaments` (–æ–¥–∏–Ω –∫ –æ–¥–Ω–æ–º—É)
- `tournament_photos` ‚Üí `tournaments` (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)
- `bankroll_transactions` ‚Üí `users` (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)
- `user_settings` ‚Üí `users` (–æ–¥–∏–Ω –∫ –æ–¥–Ω–æ–º—É –ø–æ telegram_id)

## üîß –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤

–í—Å–µ –Ω–æ–≤—ã–µ SQL —Å–∫—Ä–∏–ø—Ç—ã –¥–æ–ª–∂–Ω—ã —Ä–∞–∑–º–µ—â–∞—Ç—å—Å—è –≤ —ç—Ç–æ–π –ø–∞–ø–∫–µ —Å–æ —Å–ª–µ–¥—É—é—â–∏–º –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ–º:
- `YYYY-MM-DD_–æ–ø–∏—Å–∞–Ω–∏–µ.sql` –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π
- `feature_–Ω–∞–∑–≤–∞–Ω–∏–µ.sql` –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- `fix_–ø—Ä–æ–±–ª–µ–º–∞.sql` –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

---
*–û–±–Ω–æ–≤–ª–µ–Ω–æ: 9 —Å–µ–Ω—Ç—è–±—Ä—è 2025*


